# ðŸ—ï¸ MadBoat v2.0 - Arquitetura Otimizada Monorepo
architecture_info:
  name: "MadBoat v2.0 - Arquitetura Profissional Otimizada"
  version: "2.0.0"
  pattern: "Monorepo com Domain-Driven Design (DDD)"
  created_at: "2025-08-29"
  updated_at: "2025-08-29"
  architect: "Claude Opus 4.1"

# ðŸŽ¯ ESTRUTURA MONOREPO PRINCIPAL
monorepo_structure:
  root: "madboat-ecosystem/"
  pattern: "Turborepo + pnpm workspaces"
  
  benefits:
    - "CÃ³digo compartilhado entre web/mobile"
    - "Type safety cross-platform"
    - "Deploy sincronizado"
    - "Desenvolvimento paralelo eficiente"
    - "Single source of truth"

# ðŸ“ ESTRUTURA DE PASTAS OTIMIZADA
folder_structure:
  ```
  madboat-ecosystem/
  â”œâ”€â”€ apps/                          # AplicaÃ§Ãµes
  â”‚   â”œâ”€â”€ web/                       # Next.js 15
  â”‚   â”‚   â”œâ”€â”€ app/                   # App Router
  â”‚   â”‚   â”‚   â”œâ”€â”€ (auth)/           # Auth flows
  â”‚   â”‚   â”‚   â”œâ”€â”€ (onboarding)/     # Onboarding
  â”‚   â”‚   â”‚   â”œâ”€â”€ (dashboard)/      # Hub central
  â”‚   â”‚   â”‚   â”œâ”€â”€ (worlds)/         # Mundos
  â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ alma/         # MÃ©todo A.L.M.A.
  â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ [phase]/  # Fases dinÃ¢micas
  â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ _components/
  â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ vortex/       # MÃ©todo VÃ³rtice
  â”‚   â”‚   â”‚   â”‚   â””â”€â”€ odisseia/     # Odisseia DEV
  â”‚   â”‚   â”‚   â”‚       â””â”€â”€ [level]/  # NÃ­veis dinÃ¢micos
  â”‚   â”‚   â”‚   â”œâ”€â”€ (systems)/        # Sistemas transversais
  â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ diary/        # DiÃ¡rio de Bordo
  â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ chat/         # Chat GÃªnio
  â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ network/      # Network System
  â”‚   â”‚   â”‚   â”‚   â””â”€â”€ upgrade/      # Sistema Upgrade
  â”‚   â”‚   â”‚   â””â”€â”€ (admin)/          # Admin panel
  â”‚   â”‚   â””â”€â”€ middleware.ts         # Auth + persona middleware
  â”‚   â”‚
  â”‚   â””â”€â”€ mobile/                    # Expo/React Native
  â”‚       â”œâ”€â”€ app/                   # Expo Router
  â”‚       â”œâ”€â”€ components/            # Mobile components
  â”‚       â””â”€â”€ navigation/            # Stack navigation
  â”‚
  â”œâ”€â”€ packages/                      # Pacotes compartilhados
  â”‚   â”œâ”€â”€ core/                     # Core business logic
  â”‚   â”‚   â”œâ”€â”€ personas/             # Sistema de personas
  â”‚   â”‚   â”‚   â”œâ”€â”€ assessment/      # Algoritmos assessment
  â”‚   â”‚   â”‚   â”œâ”€â”€ types/           # Tipos de personas
  â”‚   â”‚   â”‚   â””â”€â”€ adapters/        # AdaptaÃ§Ãµes por persona
  â”‚   â”‚   â”œâ”€â”€ worlds/              # LÃ³gica dos mundos
  â”‚   â”‚   â”‚   â”œâ”€â”€ alma/            # Metodologia A.L.M.A.
  â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ phases/      # 4 fases
  â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ tracks/      # 3 trilhas
  â”‚   â”‚   â”‚   â”‚   â””â”€â”€ rules/       # Business rules
  â”‚   â”‚   â”‚   â”œâ”€â”€ vortex/          # Metodologia VÃ³rtice
  â”‚   â”‚   â”‚   â””â”€â”€ odisseia/        # Odisseia DEV
  â”‚   â”‚   â”‚       â””â”€â”€ levels/      # 5 nÃ­veis
  â”‚   â”‚   â”œâ”€â”€ gamification/        # Sistema Upgrade
  â”‚   â”‚   â”‚   â”œâ”€â”€ challenges/      # Desafios
  â”‚   â”‚   â”‚   â”œâ”€â”€ missions/        # MissÃµes
  â”‚   â”‚   â”‚   â””â”€â”€ achievements/    # Conquistas
  â”‚   â”‚   â””â”€â”€ analytics/           # Analytics engine
  â”‚   â”‚       â”œâ”€â”€ collectors/      # Coletores de dados
  â”‚   â”‚       â”œâ”€â”€ processors/      # Processamento JSONl
  â”‚   â”‚       â””â”€â”€ insights/        # GeraÃ§Ã£o de insights
  â”‚   â”‚
  â”‚   â”œâ”€â”€ ui/                      # Componentes UI compartilhados
  â”‚   â”‚   â”œâ”€â”€ primitives/          # Radix UI + custom
  â”‚   â”‚   â”œâ”€â”€ components/          # Componentes reutilizÃ¡veis
  â”‚   â”‚   â”œâ”€â”€ layouts/             # Layouts por persona
  â”‚   â”‚   â””â”€â”€ themes/              # Temas por persona
  â”‚   â”‚
  â”‚   â”œâ”€â”€ api/                     # API compartilhada
  â”‚   â”‚   â”œâ”€â”€ supabase/           # Cliente Supabase
  â”‚   â”‚   â”œâ”€â”€ hume/               # Hume AI integration
  â”‚   â”‚   â””â”€â”€ services/           # ServiÃ§os de negÃ³cio
  â”‚   â”‚
  â”‚   â”œâ”€â”€ stores/                  # Estado global (Zustand)
  â”‚   â”‚   â”œâ”€â”€ user/               # User state
  â”‚   â”‚   â”œâ”€â”€ persona/            # Persona state
  â”‚   â”‚   â”œâ”€â”€ progress/           # Progress tracking
  â”‚   â”‚   â””â”€â”€ gamification/       # Gamification state
  â”‚   â”‚
  â”‚   â””â”€â”€ utils/                   # Utilities
  â”‚       â”œâ”€â”€ validators/          # Zod schemas
  â”‚       â”œâ”€â”€ formatters/          # Formatadores
  â”‚       â””â”€â”€ helpers/             # Helpers gerais
  â”‚
  â”œâ”€â”€ services/                     # MicroserviÃ§os
  â”‚   â”œâ”€â”€ analytics-engine/        # Processamento analytics
  â”‚   â”‚   â”œâ”€â”€ collectors/          # Data collection
  â”‚   â”‚   â”œâ”€â”€ processors/          # JSONl processing
  â”‚   â”‚   â””â”€â”€ api/                 # Analytics API
  â”‚   â”‚
  â”‚   â”œâ”€â”€ chat-genie/              # Chat AI service
  â”‚   â”‚   â”œâ”€â”€ prompts/             # Prompt engineering
  â”‚   â”‚   â”œâ”€â”€ contexts/            # Contextos por mundo
  â”‚   â”‚   â””â”€â”€ emotions/            # Emotional processing
  â”‚   â”‚
  â”‚   â””â”€â”€ notification-service/    # NotificaÃ§Ãµes
  â”‚       â”œâ”€â”€ push/                # Push notifications
  â”‚       â”œâ”€â”€ email/               # Email service
  â”‚       â””â”€â”€ in-app/              # In-app notifications
  â”‚
  â”œâ”€â”€ infrastructure/              # Infraestrutura
  â”‚   â”œâ”€â”€ docker/                  # Docker configs
  â”‚   â”‚   â”œâ”€â”€ web.Dockerfile
  â”‚   â”‚   â”œâ”€â”€ services.Dockerfile
  â”‚   â”‚   â””â”€â”€ docker-compose.yml
  â”‚   â”‚
  â”‚   â”œâ”€â”€ kubernetes/              # K8s configs (futuro)
  â”‚   â”œâ”€â”€ terraform/               # IaC (futuro)
  â”‚   â””â”€â”€ scripts/                 # Deploy scripts
  â”‚
  â”œâ”€â”€ supabase/                    # Supabase project
  â”‚   â”œâ”€â”€ migrations/             # Database migrations
  â”‚   â”œâ”€â”€ functions/              # Edge functions
  â”‚   â”œâ”€â”€ seed/                   # Seed data
  â”‚   â””â”€â”€ policies/               # RLS policies
  â”‚
  â”œâ”€â”€ docs/                        # DocumentaÃ§Ã£o
  â”‚   â”œâ”€â”€ architecture/           # DecisÃµes arquiteturais
  â”‚   â”œâ”€â”€ api/                    # API documentation
  â”‚   â”œâ”€â”€ business/               # Business rules
  â”‚   â””â”€â”€ deployment/             # Deploy guides
  â”‚
  â”œâ”€â”€ config/                      # ConfiguraÃ§Ãµes
  â”‚   â”œâ”€â”€ turbo.json              # Turborepo config
  â”‚   â”œâ”€â”€ pnpm-workspace.yaml     # pnpm workspaces
  â”‚   â””â”€â”€ tsconfig.base.json      # TypeScript base
  â”‚
  â””â”€â”€ tests/                       # Testes
      â”œâ”€â”€ e2e/                    # End-to-end
      â”œâ”€â”€ integration/            # IntegraÃ§Ã£o
      â””â”€â”€ unit/                   # UnitÃ¡rios
  ```

# ðŸ”„ OTIMIZAÃ‡Ã•ES IMPLEMENTADAS

otimizacoes_arquiteturais:
  
  1_monorepo_structure:
    problema: "CÃ³digo duplicado entre web/mobile"
    solucao: "Monorepo com packages compartilhados"
    beneficios:
      - "80% cÃ³digo reutilizado"
      - "Type safety garantido"
      - "ManutenÃ§Ã£o centralizada"
      
  2_domain_driven_design:
    problema: "LÃ³gica de negÃ³cio espalhada"
    solucao: "Packages por domÃ­nio (personas, worlds, gamification)"
    beneficios:
      - "SeparaÃ§Ã£o clara de responsabilidades"
      - "Testabilidade melhorada"
      - "EvoluÃ§Ã£o independente"
      
  3_persona_first_architecture:
    problema: "Personas como afterthought"
    solucao: "Persona middleware + layouts dedicados"
    beneficios:
      - "PersonalizaÃ§Ã£o profunda"
      - "Performance otimizada por perfil"
      - "UX adaptativa real"
      
  4_progressive_complexity:
    problema: "Complexidade inicial overwhelming"
    solucao: "Lazy loading por mundo/feature"
    beneficios:
      - "Bundle size reduzido"
      - "Time to interactive melhor"
      - "ProgressÃ£o natural"
      
  5_analytics_pipeline:
    problema: "Analytics desorganizado"
    solucao: "Service dedicado com pipeline estruturado"
    beneficios:
      - "Privacy by design"
      - "Insights em tempo real"
      - "Escalabilidade garantida"

# ðŸŽ¯ ESTRATÃ‰GIA DE IMPLEMENTAÃ‡ÃƒO

implementation_strategy:
  
  fase_1_mvp:
    semana: "1-2"
    foco: "Core mÃ­nimo funcional"
    entregaveis:
      - "apps/web bÃ¡sico"
      - "packages/ui primitivos"
      - "packages/api/supabase"
      - "packages/core/personas bÃ¡sico"
      
  fase_2_alma:
    semana: "3-4"
    foco: "Mundo A.L.M.A. completo"
    entregaveis:
      - "packages/core/worlds/alma"
      - "apps/web/(worlds)/alma"
      - "packages/stores/progress"
      
  fase_3_sistemas:
    semana: "5-6"
    foco: "Sistemas transversais"
    entregaveis:
      - "apps/web/(systems)/*"
      - "packages/core/gamification"
      - "services/chat-genie"
      
  fase_4_mobile:
    semana: "7-8"
    foco: "App mobile"
    entregaveis:
      - "apps/mobile setup"
      - "ReutilizaÃ§Ã£o packages"
      - "Navigation structure"
      
  fase_5_scale:
    semana: "9-12"
    foco: "Vortex + Odisseia"
    entregaveis:
      - "Mundos completos"
      - "Analytics engine"
      - "Admin panel"

# ðŸ” SEPARAÃ‡ÃƒO DE CONCERNS

separation_of_concerns:
  
  presentation_layer:
    web: "apps/web - Next.js components"
    mobile: "apps/mobile - React Native components"
    shared: "packages/ui - Design system"
    
  business_layer:
    core: "packages/core - Business rules"
    services: "services/* - Microservices"
    api: "packages/api - Service layer"
    
  data_layer:
    database: "supabase - PostgreSQL"
    state: "packages/stores - Client state"
    cache: "React Query + Redis"
    
  infrastructure_layer:
    deployment: "infrastructure/* - Docker/K8s"
    monitoring: "services/analytics-engine"
    security: "middleware + RLS policies"

# ðŸš€ VANTAGENS DA NOVA ARQUITETURA

architectural_benefits:
  
  development_velocity:
    - "Desenvolvimento paralelo web/mobile"
    - "Hot reload em todo monorepo"
    - "Type safety cross-platform"
    - "Shared testing infrastructure"
    
  scalability:
    - "Microservices quando necessÃ¡rio"
    - "Lazy loading por feature"
    - "CDN-ready architecture"
    - "Horizontal scaling preparado"
    
  maintainability:
    - "Single source of truth"
    - "Clear separation of concerns"
    - "Documented business rules"
    - "Testability by design"
    
  performance:
    - "Bundle splitting inteligente"
    - "Persona-based optimization"
    - "Edge computing ready"
    - "Progressive enhancement"

# ðŸ”„ FLUXO DE DADOS OTIMIZADO

data_flow:
  ```
  User Input (Web/Mobile)
      â†“
  Middleware (Auth + Persona)
      â†“
  Route Handler (Next.js/Expo)
      â†“
  Business Logic (packages/core)
      â†“
  State Management (packages/stores)
      â†“
  API Layer (packages/api)
      â†“
  Supabase (Database + Auth)
      â†“
  Analytics Pipeline (services/analytics)
      â†“
  Insights Generation
  ```

# ðŸŽ¨ PERSONALIZAÃ‡ÃƒO POR PERSONA

persona_architecture:
  
  middleware_strategy:
    location: "apps/web/middleware.ts"
    responsibilities:
      - "Detect user persona"
      - "Route to persona layout"
      - "Load persona preferences"
      - "Apply persona theme"
      
  layout_variations:
    analitico: "Data-heavy, structured, metrics"
    criativo: "Visual, fluid, inspirational"
    emotivo: "Warm, community, relational"
    pragmatico: "Direct, action-oriented, efficient"
    inseguro: "Supportive, guided, encouraging"
    
  component_adaptation:
    strategy: "Composition over configuration"
    example: "PersonaAdapter wraps all components"
    benefits: "Type-safe persona handling"

# ðŸ”§ FERRAMENTAS E TECNOLOGIAS

tech_stack_optimized:
  
  build_tools:
    monorepo: "Turborepo"
    package_manager: "pnpm"
    bundler: "Vite (web) + Metro (mobile)"
    
  development:
    typescript: "5.0+ with strict mode"
    linting: "ESLint + Prettier"
    testing: "Vitest + Playwright"
    
  deployment:
    web: "Docker â†’ Hetzner"
    mobile: "EAS Build â†’ App Stores"
    services: "Docker Compose â†’ Kubernetes"
    
  monitoring:
    analytics: "Custom JSONl pipeline"
    errors: "Sentry"
    performance: "Vercel Analytics"
    uptime: "UptimeRobot"

# ðŸ“Š MÃ‰TRICAS DE SUCESSO

success_metrics:
  
  technical_kpis:
    code_reuse: "> 70% between platforms"
    test_coverage: "> 80% critical paths"
    build_time: "< 5 minutes full build"
    deploy_time: "< 10 minutes production"
    
  architecture_kpis:
    coupling: "Low coupling between packages"
    cohesion: "High cohesion within packages"
    complexity: "Cyclomatic complexity < 10"
    maintainability: "A rating on CodeClimate"
    
  business_kpis:
    time_to_feature: "50% reduction"
    bug_rate: "< 1 per 1000 users"
    performance: "< 3s initial load"
    scalability: "10,000+ concurrent users"

# ðŸš¨ PONTOS CRÃTICOS DE ATENÃ‡ÃƒO

critical_considerations:
  
  security:
    - "Persona data encryption"
    - "API rate limiting"
    - "SQL injection prevention"
    - "XSS protection"
    
  performance:
    - "Bundle size monitoring"
    - "Database query optimization"
    - "Image optimization"
    - "Caching strategy"
    
  scalability:
    - "Database connection pooling"
    - "Microservices boundaries"
    - "State management size"
    - "WebSocket connections"
    
  maintainability:
    - "Documentation updates"
    - "Dependency management"
    - "Technical debt tracking"
    - "Code review standards"

# ðŸŽ¯ PRÃ“XIMOS PASSOS IMEDIATOS

immediate_actions:
  1_setup_monorepo:
    commands:
      - "npx create-turbo@latest madboat-ecosystem"
      - "Setup pnpm workspaces"
      - "Configure TypeScript paths"
      
  2_create_core_packages:
    priority:
      - "packages/core/personas"
      - "packages/api/supabase"
      - "packages/ui/primitives"
      
  3_implement_mvp:
    focus:
      - "Login/Auth flow"
      - "Persona assessment"
      - "Basic dashboard"
      
  4_deploy_pipeline:
    setup:
      - "Docker configuration"
      - "GitHub Actions"
      - "Hetzner deployment"